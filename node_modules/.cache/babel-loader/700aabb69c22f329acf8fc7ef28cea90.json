{"ast":null,"code":"import _regeneratorRuntime from \"/home/lhk/web3-practice/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _toConsumableArray from \"/home/lhk/web3-practice/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"/home/lhk/web3-practice/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/home/lhk/web3-practice/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/lhk/web3-practice/src/components/Main.js\";\nimport logo from '../한강.png';\nimport React, { useEffect, useState } from \"react\";\nimport { connectWallet, getCurrentWalletConnected, mintNFT } from \"../utils/interact.js\";\nimport Web3 from 'web3';\nimport erc721Abi from \"../erc721Abi\";\nimport TokenList from \"./TokenList\";\nimport axios from \"axios\";\n\nfunction Main() {\n  var _this = this;\n\n  var _useState = useState(\"\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      walletAddress = _useState2[0],\n      setWallet = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      status = _useState4[0],\n      setStatus = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      name = _useState6[0],\n      setName = _useState6[1];\n\n  var _useState7 = useState(\"\"),\n      _useState8 = _slicedToArray(_useState7, 2),\n      description = _useState8[0],\n      setDescription = _useState8[1];\n\n  var _useState9 = useState(\"\"),\n      _useState10 = _slicedToArray(_useState9, 2),\n      url = _useState10[0],\n      setURL = _useState10[1];\n\n  var _useState11 = useState([]),\n      _useState12 = _slicedToArray(_useState11, 2),\n      erc721list = _useState12[0],\n      setErc721list = _useState12[1];\n\n  var _useState13 = useState(),\n      _useState14 = _slicedToArray(_useState13, 2),\n      newErc721addr = _useState14[0],\n      setNewErc721Addr = _useState14[1];\n\n  var _useState15 = useState([]),\n      _useState16 = _slicedToArray(_useState15, 2),\n      NFTlist = _useState16[0],\n      setNFTlist = _useState16[1];\n\n  var _useState17 = useState(''),\n      _useState18 = _slicedToArray(_useState17, 2),\n      img = _useState18[0],\n      setImg = _useState18[1];\n\n  var _useState19 = useState(),\n      _useState20 = _slicedToArray(_useState19, 2),\n      web3 = _useState20[0],\n      setWeb3 = _useState20[1]; // let NFTlist = [1,2,3,4,5,6,7,8,9,10]\n\n\n  useEffect(function () {\n    if (typeof window.ethereum !== \"undefined\") {\n      // window.ethereum이 있다면\n      try {\n        var web = new Web3(window.ethereum); // 새로운 web3 객체를 만든다\n\n        setWeb3(web);\n      } catch (err) {\n        console.log(err);\n      }\n    }\n  }, []);\n\n  var addNewErc721Token = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var tokenContract, totalSupply, i, token_Id, info, tokenOwner, tokenURI;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return new web3.eth.Contract(erc721Abi, '0x1af3dde6Cc151841CE93618bF10E07687c615D4A');\n\n            case 2:\n              tokenContract = _context.sent;\n              _context.next = 5;\n              return tokenContract.methods.totalSupply().call();\n\n            case 5:\n              totalSupply = _context.sent;\n              i = 0;\n\n            case 7:\n              if (!(i <= totalSupply)) {\n                _context.next = 27;\n                break;\n              }\n\n              _context.next = 10;\n              return tokenContract.methods.tokenURI(i).call();\n\n            case 10:\n              token_Id = _context.sent;\n              JSON.parse(token_Id);\n              info = JSON.parse(token_Id);\n              setName(info.name);\n              setImg(info.image);\n              setDescription(info.description);\n              _context.next = 18;\n              return tokenContract.methods.ownerOf(i).call();\n\n            case 18:\n              tokenOwner = _context.sent;\n\n              if (!(String(tokenOwner).toLowerCase() === '0x6ffd74bac21fa086d645e6407f2e9bd19595b9e0'.toLowerCase())) {\n                _context.next = 24;\n                break;\n              }\n\n              _context.next = 22;\n              return tokenContract.methods.tokenURI(i).call();\n\n            case 22:\n              tokenURI = _context.sent;\n              setErc721list(function (prevState) {\n                return [].concat(_toConsumableArray(prevState), [{\n                  name: name,\n                  img: img,\n                  description: description\n                }]);\n              });\n\n            case 24:\n              i++;\n              _context.next = 7;\n              break;\n\n            case 27:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function addNewErc721Token() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"App\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row no-gutters\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: addNewErc721Token,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 11\n    }\n  }, \"add new erc721\"), erc721list.map(function (token) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-3\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"svg\", {\n      className: \"bd-placeholder-img\",\n      width: \"100%\",\n      height: \"250\",\n      xmlns: \"http://www.w3.org/2000/svg\",\n      \"aria-label\": \"Placeholder: Image\",\n      preserveAspectRatio: \"xMidYMid slice\",\n      role: \"img\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"card\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      class: \"card-img-top\",\n      src: token.img,\n      alt: \"logo\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 23\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"card-body\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"h5\", {\n      class: \"card-title\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 25\n      }\n    }, token.name), /*#__PURE__*/React.createElement(\"p\", {\n      class: \"card-text\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 25\n      }\n    }, \"\\uC124\\uBA85: \", token.description, \" \"), /*#__PURE__*/React.createElement(\"a\", {\n      href: \"/Auction\",\n      class: \"btn btn-primary\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 25\n      }\n    }, \"\\uAD6C\\uB9E4\"))));\n  }))));\n}\n\nexport default Main;","map":{"version":3,"sources":["/home/lhk/web3-practice/src/components/Main.js"],"names":["logo","React","useEffect","useState","connectWallet","getCurrentWalletConnected","mintNFT","Web3","erc721Abi","TokenList","axios","Main","walletAddress","setWallet","status","setStatus","name","setName","description","setDescription","url","setURL","erc721list","setErc721list","newErc721addr","setNewErc721Addr","NFTlist","setNFTlist","img","setImg","web3","setWeb3","window","ethereum","web","err","console","log","addNewErc721Token","eth","Contract","tokenContract","methods","totalSupply","call","i","tokenURI","token_Id","JSON","parse","info","image","ownerOf","tokenOwner","String","toLowerCase","prevState","map","token"],"mappings":"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","sourcesContent":["import logo from '../한강.png';\nimport React, { useEffect, useState } from \"react\";\nimport { connectWallet, getCurrentWalletConnected, mintNFT, } from \"../utils/interact.js\";\nimport Web3 from 'web3';\nimport erc721Abi from \"../erc721Abi\"\nimport TokenList from \"./TokenList\";\nimport axios from \"axios\";\n\nfunction Main() {\n  const [walletAddress, setWallet] = useState(\"\");\n  const [status, setStatus] = useState(\"\");\n  const [name, setName] = useState(\"\");\n  const [description, setDescription] = useState(\"\");\n  const [url, setURL] = useState(\"\");\n  const [erc721list, setErc721list] = useState([]);\n  const [newErc721addr, setNewErc721Addr] = useState();\n  const [NFTlist, setNFTlist] = useState([]);\n  const [img, setImg] = useState('')\n  const [web3, setWeb3] = useState();\n  // let NFTlist = [1,2,3,4,5,6,7,8,9,10]\n\n  useEffect(() => {\n    if (typeof window.ethereum !== \"undefined\") { // window.ethereum이 있다면\n      try {\n        const web = new Web3(window.ethereum);  // 새로운 web3 객체를 만든다\n        setWeb3(web);\n      } catch (err) {\n        console.log(err);\n      }\n    }\n  }, []);\n  const addNewErc721Token = async () => {\n\n    const tokenContract = await new web3.eth.Contract(\n      erc721Abi,\n      '0x1af3dde6Cc151841CE93618bF10E07687c615D4A'\n    );\n    const totalSupply = await tokenContract.methods.totalSupply().call();\n    for(let i=0; i<=totalSupply; i++){\n    const token_Id = await tokenContract.methods.tokenURI(i).call();\n    JSON.parse(token_Id)\n    const info = JSON.parse(token_Id);\n    setName(info.name);\n    setImg(info.image);\n    setDescription(info.description)\n    let tokenOwner = await tokenContract.methods\n        .ownerOf(i)\n        .call();\n    if (String(tokenOwner).toLowerCase() === '0x6ffd74bac21fa086d645e6407f2e9bd19595b9e0'.toLowerCase()) {\n      let tokenURI = await tokenContract.methods\n        .tokenURI(i)\n        .call();\n      setErc721list((prevState) => {\n        return [...prevState, { name, img, description}];\n      });\n    }\n    }  \n  }\n\n\n  return (\n    <div className=\"App\">\n      <div class=\"container\">\n        <div className=\"row no-gutters\">\n          <button onClick={addNewErc721Token}>add new erc721</button>\n            {\n              erc721list.map((token) => {\n                return (\n                  <div className=\"col-3\">\n                    <svg\n                      className=\"bd-placeholder-img\"\n                      width=\"100%\"\n                      height=\"250\"\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                      aria-label=\"Placeholder: Image\"\n                      preserveAspectRatio=\"xMidYMid slice\"\n                      role=\"img\">\n                    </svg>\n                    {/* <h1 className=\"title\">NFT</h1> */}\n                    <div class=\"card\">\n                      <img class=\"card-img-top\" src={token.img} alt={\"logo\"} />\n                      <div class=\"card-body\">\n                        <h5 class=\"card-title\">{token.name}</h5>\n                        <p class=\"card-text\">설명: {token.description} </p>\n                        <a href=\"/Auction\" class=\"btn btn-primary\">구매</a>\n                      </div>\n                    </div>\n                  </div>\n                )\n              })\n            }\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Main;\n"]},"metadata":{},"sourceType":"module"}